!function(){"use strict";angular.module("bottletrade.common",[]),angular.module("bottletrade.firebase",["bottletrade.firebase.routeSecurity","bottletrade.firebase.utils"]),angular.module("bottletrade.beers",["bottletrade.common","bottletrade.firebase"]),angular.module("bottletrade.breweries",["bottletrade.common","bottletrade.firebase"]),angular.module("bottletrade.wines",["bottletrade.common","bottletrade.firebase"]),angular.module("bottletrade.wineries",["bottletrade.common","bottletrade.firebase"]),angular.module("bottletrade.spirits",["bottletrade.common","bottletrade.firebase"]),angular.module("bottletrade.distilleries",["bottletrade.common","bottletrade.firebase"]),angular.module("bottletrade.bottles",["bottletrade.common","bottletrade.firebase"]),angular.module("bottletrade.profile",["bottletrade.common","bottletrade.firebase"]),angular.module("bottletrade.autocomplete",["bottletrade.common","bottletrade.firebase","bottletrade.beers","bottletrade.breweries","bottletrade.wines","bottletrade.wineries","bottletrade.spirits","bottletrade.distilleries"]),angular.module("bottletrade.search",["bottletrade.common","bottletrade.firebase","bottletrade.beers","bottletrade.breweries","bottletrade.wines","bottletrade.wineries","bottletrade.spirits","bottletrade.distilleries","bottletrade.bottles"]),angular.module("bottletrade.upload",["bottletrade.common","bottletrade.firebase","bottletrade.beers","bottletrade.breweries","bottletrade.wines","bottletrade.wineries","bottletrade.spirits","bottletrade.distilleries","bottletrade.bottles","bottletrade.search"]),angular.module("bottletrade",["bottletrade.beers","bottletrade.bottles","bottletrade.breweries","bottletrade.common","bottletrade.distilleries","bottletrade.firebase","bottletrade.profile","bottletrade.search","bottletrade.spirits","bottletrade.upload","bottletrade.wineries","bottletrade.wines","bottletrade.autocomplete"])}();
!function(t){"use strict";function i(t,i,e,o){this._state=e,this._location=t,this._rootScope=i,this._loginPath=o,this._redirectTo=null,this._authenticated=!1,this._init()}t.module("bottletrade.firebase.routeSecurity",["ui.router"]).run(["$injector","$location","$rootScope","loginRedirectPath",function(t,e,o,h){t.has("$state")&&new i(e,o,t.get("$state"),h)}]),i.prototype={_init:function(){var i=this;this._checkCurrent(),i._rootScope.$on("$stateChangeSuccess",function(t,e){i._authRequiredRedirect(e,i._loginPath)}),i._rootScope.$on("$firebaseSimpleLogin:login",t.bind(this,this._login)),i._rootScope.$on("$firebaseSimpleLogin:logout",t.bind(this,this._logout)),i._rootScope.$on("$firebaseSimpleLogin:error",t.bind(this,this._logout))},_checkCurrent:function(){this._state.current&&this._authRequiredRedirect(this._state.current,this._loginPath)},_login:function(){this._authenticated=!0,this._redirectTo?(this._redirect(this._redirectTo),this._redirectTo=null):this._location.path()===this._loginPath&&(this._location.replace(),this._location.path("/"))},_logout:function(){this._authenticated=!1,this._checkCurrent()},_redirect:function(t){this._location.replace(),this._location.path(t)},_authRequiredRedirect:function(t,i){this._authenticated=!(!this._rootScope.user||!this._rootScope.user.auth),t.data&&t.data.authRequired&&!this._authenticated?(void 0===t.pathTo?this._redirectTo=this._location.path():this._redirectTo=t.pathTo===i?"/":t.pathTo,this._redirect(i)):this._authenticated&&this._location.path()===this._loginPath&&this._redirect("/")}}}(angular);
!function(){"use strict";function r(e){for(var t=0;t<e.length;t++)e[t]&&angular.isArray(e[t])&&(e[t]=r(e[t]));return e.join("/")}angular.module("bottletrade.firebase.utils",["firebase"]).factory("firebaseRef",["Firebase","FIREBASE_URL",function(e,t){return function(n){var a=new e(t);return arguments.length&&(a=a.child(r([].concat(Array.prototype.slice.call(arguments))))),a}}]).factory("syncData",["$firebase","firebaseRef",function(r,e){return function(t,n){var a=e(t);return n&&(a=a.limit(n)),r(a)}}]).factory("encodeFirebaseKey",function(){return function(r){return(r||"").replace(/([.$\[\]#\/])/g,function(r,e){return"%"+(e+"").charCodeAt(0).toString(16).toUpperCase()})}})}();
!function(){"use strict";angular.module("bottletrade.autocomplete").directive("beerAutocomplete",["$timeout","FoundationApi","AutoCompleteManager",function(e,t,u){return{replace:!0,templateUrl:"/bottletrade/autocomplete/directives/beer-autocomplete.html",scope:{inputName:"@",selected:"="},link:function(l,o,n){l.selected=null,l.query="",l.uid="beer-autocomplete-"+t.generateUuid(),u.prepareBeerAutoComplete(l),l.$watchCollection("results",function(u,o){0===o.length&&u&&u.length>0&&e(function(){t.publish(l.uid,"show")}),0===u.length&&e(function(){t.publish(l.uid,"hide")})}),l.selectResult=function(e){l.selected=e,l.query=e.name},l.clearResult=function(){l.selected=!1,l.query=""}}}}])}();
!function(){"use strict";angular.module("bottletrade.autocomplete").directive("breweryAutocomplete",["$timeout","FoundationApi","AutoCompleteManager",function(e,t,u){return{replace:!0,templateUrl:"/bottletrade/autocomplete/directives/brewery-autocomplete.html",scope:{inputName:"@",selected:"="},link:function(l,o,n){l.selected=null,l.query="",l.uid="brewery-autocomplete-"+t.generateUuid(),u.prepareBreweryAutoComplete(l),l.$watchCollection("results",function(u,o){0===o.length&&u&&u.length>0&&e(function(){t.publish(l.uid,"show")}),0===u.length&&e(function(){t.publish(l.uid,"hide")})}),l.selectResult=function(e){l.selected=e,l.query=e.name},l.clearResult=function(){l.selected=!1,l.query=""}}}}])}();
!function(){"use strict";angular.module("bottletrade.autocomplete").directive("distilleryAutocomplete",["$timeout","FoundationApi","AutoCompleteManager",function(e,t,l){return{replace:!0,templateUrl:"/bottletrade/autocomplete/directives/distillery-autocomplete.html",scope:{inputName:"@",selected:"="},link:function(u,i,o){u.selected=null,u.query="",u.uid="distillery-autocomplete-"+t.generateUuid(),l.prepareDistilleryAutoComplete(u),u.$watchCollection("results",function(l,i){0===i.length&&l&&l.length>0&&e(function(){t.publish(u.uid,"show")}),0===l.length&&e(function(){t.publish(u.uid,"hide")})}),u.selectResult=function(e){u.selected=e,u.query=e.name},u.clearResult=function(){u.selected=!1,u.query=""}}}}])}();
!function(){"use strict";angular.module("bottletrade.autocomplete").directive("spiritAutocomplete",["$timeout","FoundationApi","AutoCompleteManager",function(e,t,u){return{replace:!0,templateUrl:"/bottletrade/autocomplete/directives/spirit-autocomplete.html",scope:{inputName:"@",selected:"="},link:function(i,l,o){i.selected=null,i.query="",i.uid="spirit-autocomplete-"+t.generateUuid(),u.prepareSpiritAutoComplete(i),i.$watchCollection("results",function(u,l){0===l.length&&u&&u.length>0&&e(function(){t.publish(i.uid,"show")}),0===u.length&&e(function(){t.publish(i.uid,"hide")})}),i.selectResult=function(e){i.selected=e,i.query=e.name},i.clearResult=function(){i.selected=!1,i.query=""}}}}])}();
!function(){"use strict";angular.module("bottletrade.autocomplete").directive("wineAutocomplete",["$timeout","FoundationApi","AutoCompleteManager",function(e,t,u){return{replace:!0,templateUrl:"/bottletrade/autocomplete/directives/wine-autocomplete.html",scope:{inputName:"@",selected:"="},link:function(l,n,o){l.selected=null,l.query="",l.uid="wine-autocomplete-"+t.generateUuid(),u.prepareWineAutoComplete(l),l.$watchCollection("results",function(u,n){0===n.length&&u&&u.length>0&&e(function(){t.publish(l.uid,"show")}),0===u.length&&e(function(){t.publish(l.uid,"hide")})}),l.selectResult=function(e){l.selected=e,l.query=e.name},l.clearResult=function(){l.selected=!1,l.query=""}}}}])}();
!function(){"use strict";angular.module("bottletrade.autocomplete").directive("wineryAutocomplete",["$timeout","FoundationApi","AutoCompleteManager",function(e,t,u){return{replace:!0,templateUrl:"/bottletrade/autocomplete/directives/winery-autocomplete.html",scope:{inputName:"@",selected:"="},link:function(l,n,o){l.selected=null,l.query="",l.uid="winery-autocomplete-"+t.generateUuid(),u.prepareWineryAutoComplete(l),l.$watchCollection("results",function(u,n){0===n.length&&u&&u.length>0&&e(function(){t.publish(l.uid,"show")}),0===u.length&&e(function(){t.publish(l.uid,"hide")})}),l.selectResult=function(e){l.selected=e,l.query=e.name},l.clearResult=function(){l.selected=!1,l.query=""}}}}])}();
!function(){"use strict";angular.module("bottletrade.autocomplete").factory("AutoCompleteManager",["$timeout","firebaseRef","BTConstants","BeerManager","BreweryManager","SpiritManager","DistilleryManager","WineManager","WineryManager",function(e,r,a,n,t,s,i,u,c){function o(e){return f("beer",e)}function l(e){return f("brewery",e)}function f(r,a){var o=null,l="";a.results=[],a.loading=!1,a.performSearch=function(f){function g(r,n){o===y&&(n.$id=r,e(function(){a.results.push(n)}))}function B(r,n){o===y&&e(function(){lodash.remove(a.results,function(e){return e.$id==r})})}var y;if(f!==l)switch(y=new Date,o=y,l=f,a.results.splice(0,a.results.length),r){case"beer":n.searchByNameBegins(f,g,B);break;case"brewery":t.searchByNameBegins(f,g,B);break;case"wine":u.searchByNameBegins(f,g,B);break;case"winery":c.searchByNameBegins(f,g,B);break;case"spirit":s.searchByNameBegins(f,g,B);break;case"distillery":i.searchByNameBegins(f,g,B)}},a.$watch("query",function(e,r){e?a.performSearch(e):(l="",o=new Date,a.results.splice(0,a.results.length))})}return{prepareBeerAutoComplete:o,prepareBreweryAutoComplete:l}}])}();
!function(){"use strict";angular.module("bottletrade.beers").directive("addBeer",["FoundationApi","BeerList",function(e,r){return{replace:!0,templateUrl:"/bottletrade/beers/directives/add-beer.html",scope:{created:"&",beer:"=?",updated:"&"},link:function(e,t,d){e.isNew=!d.beer,e.isNew&&(e.beer={}),e.save=function(){e.add_beer_form.$submitted=!0,e.add_beer_form.$valid&&(e.beer.brewery?e.isNew?r.$add(e.beer).then(function(r){e.created({beer:r})}):e.beer.$save().then(function(r){e.updated({beer:r})}):e.add_beer_form.beer_brewery.$setValidity("required",!1))}}}}])}();
!function(){"use strict";angular.module("bottletrade.beers").directive("beerDisplay",function(){return{replace:!0,templateUrl:"/bottletrade/beers/directives/beer-display.html",scope:{beer:"="},link:function(e,t){}}})}();
!function(){"use strict";angular.module("bottletrade.beers").directive("beerSummary",function(){return{replace:!0,templateUrl:"/bottletrade/beers/directives/beer-summary.html",scope:{beer:"="},link:function(e,r){}}})}();
!function(){"use strict";angular.module("bottletrade.beers").factory("Beer",["$firebaseObject","firebaseRef","BTConstants","Brewery",function(e,r,t,n){return function(s){var a=e.$extend({$save:function(){return this.search_name=this.name.toLowerCase(),angular.isString(this.brewery)||(this.brewery=this.brewery.$id),e.prototype.$save.call(this)},$$updated:function(r){var t=e.prototype.$$updated.apply(this,arguments);return t&&angular.isString(this.brewery)&&(this.brewery=new n(this.brewery)),t}});return new a(r(t.firebase.beers,s))}}])}();
!function(){"use strict";angular.module("bottletrade.beers").factory("BeerList",["$firebaseArray","firebaseRef","BTConstants","Brewery",function(e,r,t,a){var n=e.$extend({$add:function(r){return r.search_name=r.name.toLowerCase(),angular.isString(r.brewery)||(r.brewery=r.brewery.$id),e.prototype.$add.call(this,r)},$$added:function(r,t){var n=e.prototype.$$added.apply(this,arguments);return n&&angular.isString(n.brewery)&&(n.brewery=new a(n.brewery)),n},$$updated:function(r){var t=e.prototype.$$updated.apply(this,arguments);return t&&angular.isString(r.brewery)&&(r.brewery=new a(r.brewery)),t}});return new n(r(t.firebase.beers))}])}();
!function(){"use strict";angular.module("bottletrade.beers").factory("BeerManager",["firebaseRef","BTConstants",function(e,n){function a(e,n,a){i(e,null,"","","","~",n,a)}function r(e,n,a){i(e,null,"~","","~","",n,a)}function t(e,n,a){i(e,null,"~","~","~","~",n,a)}function o(e,n,a){i(e,null,"","","","",n,a)}function c(e,n,a,r){i(e,n,"","","","",a,r)}function i(a,r,t,o,c,i,s,l){var u,f;u=a.toString().toLowerCase(),f=e(n.firebase.beers).orderByChild("search_name").startAt(t+u+o).endAt(c+u+i),s&&f.on("child_added",function(e){r&&e.val().brewery!==r||s(e.key(),e.val())}),l&&f.on("child_removed",function(e){r&&e.val().brewery!==r||l(e.key(),e.val())})}return{searchByNameBegins:a,searchByNameEnds:r,searchByNameContains:t,searchByNameExact:o,searchByNameExactFromBrewery:c}}])}();
!function(){"use strict";angular.module("bottletrade.bottles").directive("addBottle",["BottleList",function(e){return{restrict:"E",replace:!0,templateUrl:"/bottletrade/bottles/directives/add-bottle.html",scope:{beer:"=?",wine:"=?",spirit:"=?",bottle:"=?",created:"&",updated:"&"},link:function(t,i,o){t.isNew=!o.bottle,t.isNew&&(t.bottle={description:""},o.beer?(t.bottle.type="beer",t.bottle.beverage=t.beer):o.wine?(t.bottle.type="wine",t.bottle.beverage=t.wine):o.spirit&&(t.bottle.type="spirit",t.bottle.beverage=t.spirit)),t.save=function(){t.isNew?(new e).$add(t.bottle).then(function(e){t.created({bottle:e})}):t.beer.$save().then(function(e){t.updated({bottle:bottle})})}}}}])}();
!function(){"use strict";angular.module("bottletrade.bottles").directive("bottleDisplay",function(){return{restrict:"E",replace:!0,templateUrl:"/bottletrade/bottles/directives/bottle-display.html",scope:{bottle:"="},link:function(t,e){}}})}();
!function(){"use strict";angular.module("bottletrade.bottles").directive("bottleSummary",["$timeout","FoundationApi","BottleList",function(t,e,o){return{restrict:"E",replace:!0,templateUrl:"/bottletrade/bottles/directives/bottle-summary.html",scope:{bottle:"=",removeBottle:"&"},link:function(t,e){}}}])}();
!function(){"use strict";angular.module("bottletrade.bottles").factory("Bottle",["$rootScope","$firebaseObject","firebaseRef","BTConstants","Beer","Wine","Spirit",function(e,t,r,a,i,s,n){return function(o){var b=t.$extend({$save:function(){return this.beverage=this.beverage.$id,t.prototype.$save.call(this)},$$updated:function(e){var r=t.prototype.$$updated.apply(this,arguments);if(r)switch(this.type){case"beer":this.beverage=new i(this.beverage);break;case"wine":this.beverage=new s(this.beverage);break;case"spirit":this.beverage=new n(this.beverage)}return r}});return new b(r(a.firebase.bottles,e.user.auth.uid,o))}}])}();
!function(){"use strict";angular.module("bottletrade.bottles").factory("BottleList",["$rootScope","$firebaseArray","firebaseRef","BTConstants","Beer","Wine","Spirit",function(e,r,t,a,n,i,b){var s=r.$extend({$add:function(e){return e.beverage=e.beverage.$id,r.prototype.$add.call(this,e)},$$added:function(e,t){var a=r.prototype.$$added.apply(this,arguments);if(a)switch(a.type){case"beer":a.beverage=new n(a.beverage);break;case"wine":a.beverage=new i(a.beverage);break;case"spirit":a.beverage=new b(a.beverage)}return a},$$updated:function(e){var t=r.prototype.$$updated.apply(this,arguments);if(t)switch(e.type){case"beer":e.beverage=new n(e.beverage);break;case"wine":e.beverage=new i(e.beverage);break;case"spirit":e.beverage=new b(e.beverage)}return t}});return function(){return e.user?new s(t(a.firebase.bottles,e.user.auth.uid)):null}}])}();
!function(){"use strict";angular.module("bottletrade.bottles").factory("BottleManager",["$timeout","FoundationApi","firebaseRef","BTConstants","BottleList",function(e,t,o,n,i){function r(o){var n=o.beverage.name;o.$remove().then(function(o){e(function(){t.publish("app-notifications",{title:"Bottle Removed!",content:n+" has been removed from your cellar",color:"success",autoclose:"5000"})})})}function a(o,n){var i=n.beverage.name;o.$remove(n).then(function(o){e(function(){t.publish("app-notifications",{title:"Bottle Removed!",content:i+" has been removed from your cellar",color:"success",autoclose:"5000"})})})}function c(e,t){o(n.firebase.bottles).orderByChild("description").startAt("~"+e).endAt("~"+e+"~").on("child_added",function(e){t(e.key(),e.val())})}return{searchByDescription:c,removeFromList:a,remove:r}}])}();
!function(){"use strict";angular.module("bottletrade.breweries").directive("addBrewery",["BreweryList",function(e){return{replace:!0,templateUrl:"/bottletrade/breweries/directives/add-brewery.html",scope:{created:"&",brewery:"=?",updated:"&"},link:function(r,t,d){r.isNew=!d.brewery,r.isNew&&(r.brewery={}),r.save=function(){r.add_brewery_form.$submitted=!0,r.add_brewery_form.$valid&&(r.isNew?e.$add(r.brewery).then(function(e){r.created({brewery:e})}):r.brewery.$save().then(function(e){r.updated({brewery:e})}))}}}}])}();
!function(){"use strict";angular.module("bottletrade.breweries").directive("breweryDisplay",function(){return{replace:!0,templateUrl:"/bottletrade/breweries/directives/brewery-display.html",scope:{brewery:"="},link:function(e,r){}}})}();
!function(){"use strict";angular.module("bottletrade.breweries").directive("brewerySummary",function(){return{replace:!0,templateUrl:"/bottletrade/breweries/directives/brewery-summary.html",scope:{brewery:"="},link:function(e,r){}}})}();
!function(){"use strict";angular.module("bottletrade.breweries").factory("Brewery",["$firebaseObject","firebaseRef","BTConstants",function(e,r,t){return function(n){var a=e.$extend({$save:function(){return this.search_name=this.name.toLowerCase(),e.prototype.$save.call(this)}});return new a(r(t.firebase.breweries,n))}}])}();
!function(){"use strict";angular.module("bottletrade.breweries").factory("BreweryList",["$firebaseArray","firebaseRef","BTConstants",function(e,r,t){var a=e.$extend({$add:function(r){return r.search_name=r.name.toLowerCase(),e.prototype.$add.call(this,r)}});return new a(r(t.firebase.breweries))}])}();
!function(){"use strict";angular.module("bottletrade.breweries").factory("BreweryManager",["firebaseRef","BTConstants",function(e,n){function r(e,n,r){return i(e,"","","","~",n,r)}function t(e,n,r){return i(e,"~","","~","",n,r)}function a(e,n,r){return i(e,"~","~","~","~",n,r)}function o(e,n,r){return i(e,"","","","",n,r)}function i(r,t,a,o,i,c,s){var u,f;u=r.toString().toLowerCase(),f=e(n.firebase.breweries).orderByChild("search_name").startAt(t+u+a).endAt(o+u+i),c&&f.on("child_added",function(e){c(e.key(),e.val())}),s&&f.on("child_removed",function(e){s(e.key(),e.val())})}return{searchByNameBegins:r,searchByNameEnds:t,searchByNameContains:a,searchByNameExact:o}}])}();
!function(){"use strict";angular.module("bottletrade").constant("BTConstants",{beverages:{beer:"beer",wine:"wine",spirit:"spirit"},companies:{brewery:"brewery",winery:"winery",distillery:"distillery"},firebase:{bottles:"bottles",beers:"beers",wines:"wines",spirits:"spirits",breweries:"breweries",wineries:"wineries",distilleries:"distilleries"}})}();
!function(){"use strict";angular.module("bottletrade.common").factory("fileReader",["$q","$log",function(r,e){function n(r,e,n){return function(){n.$apply(function(){e.resolve(r.result)})}}function t(r,e,n){return function(){n.$apply(function(){e.reject(r.result)})}}function o(r,e){return function(r){e.$broadcast("fileProgress",{total:r.total,loaded:r.loaded})}}function a(r,e){var a=new FileReader;return a.onload=n(a,r,e),a.onerror=t(a,r,e),a.onprogress=o(a,e),a}function u(e,n){var t=r.defer(),o=a(t,n);return o.readAsDataURL(e),t.promise}function i(e,n){var t=r.defer(),o=a(t,n);return o.readAsText(e),t.promise}return{readAsDataUrl:u,readAsText:i}}])}();
!function(){"use strict";angular.module("bottletrade.distilleries").directive("addDistillery",["DistilleryList",function(e){return{replace:!0,templateUrl:"/bottletrade/distilleries/directives/add-distillery.html",scope:{created:"&"},link:function(t,i){t.distillery={name:""},t.save=function(){e.$add(t.distillery).then(function(e){t.created({distillery:e})})}}}}])}();
!function(){"use strict";angular.module("bottletrade.distilleries").directive("distilleryDisplay",function(){return{replace:!0,templateUrl:"/bottletrade/distilleries/directives/distillery-display.html",scope:{distillery:"="},link:function(e,i){}}})}();
!function(){"use strict";angular.module("bottletrade.distilleries").directive("distillerySummary",function(){return{replace:!0,templateUrl:"/bottletrade/distilleries/directives/distillery-summary.html",scope:{distillery:"="},link:function(e,t){}}})}();
!function(){"use strict";angular.module("bottletrade.distilleries").factory("Distillery",["$firebaseObject","firebaseRef","BTConstants",function(e,t,r){return function(i){var s=e.$extend({$save:function(){return this.search_name=this.name.toLowerCase(),e.prototype.$save.call(this)}});return new s(t(r.firebase.distilleries,i))}}])}();
!function(){"use strict";angular.module("bottletrade.distilleries").factory("DistilleryList",["$firebaseArray","firebaseRef","BTConstants",function(e,t,r){var a=e.$extend({$add:function(t){return t.search_name=t.name.toLowerCase(),e.prototype.$add.call(this,t)}});return new a(t(r.firebase.distilleries))}])}();
!function(){"use strict";angular.module("bottletrade.distilleries").factory("DistilleryManager",["firebaseRef","BTConstants",function(e,n){function t(e,n,t){return o(e,"","","","~",n,t)}function r(e,n,t){return o(e,"~","","~","",n,t)}function a(e,n,t){return o(e,"~","~","~","~",n,t)}function i(e,n,t){return o(e,"","","","",n,t)}function o(t,r,a,i,o,s,c){var u,d;u=t.toString().toLowerCase(),d=e(n.firebase.distilleries).orderByChild("search_name").startAt(r+u+a).endAt(i+u+o),s&&d.on("child_added",function(e){s(e.key(),e.val())}),c&&d.on("child_removed",function(e){c(e.key(),e.val())})}return{searchByNameBegins:t,searchByNameEnds:r,searchByNameContains:a,searchByNameExact:i}}])}();
!function(){"use strict";angular.module("bottletrade.firebase").constant("FIREBASE_URL","https://amber-torch-76.firebaseio.com/").constant("loginRedirectPath","/account/login").constant("FEED_SYNC_LIMIT",5).constant("authProviders",[{id:"twitter",name:"Twitter",icon:"icon-twitter"},{id:"facebook",name:"Facebook",icon:"icon-facebook"},{id:"email",name:"Email",icon:"icon-envelope"}])}();
!function(){"use strict";angular.module("bottletrade.firebase").factory("Auth",["$firebaseAuth","firebaseRef",function(e,t){return e(t())}])}();
!function(){"use strict";angular.module("bottletrade.profile").directive("profile",["Profile",function(e){return{replace:!0,templateUrl:"/bottletrade/profile/directives/profile.html",scope:{username:"="},link:function(r,t){r.profile=new e(username),r.saveProfile=function(){$scope.profile.$save().then(function(){alert("Profile saved to Firebase!")})["catch"](function(e){alert("Error!")})}}}}])}();
!function(){"use strict";angular.module("bottletrade.profile").factory("Profile",["$firebaseObject","FirebaseRef",function(e,r){return function(t){var i=new r("profile"),n=i.child(t);return e(n)}}])}();
!function(){"use strict";angular.module("bottletrade.search").directive("searchResult",function(){return{replace:!0,templateUrl:"/bottletrade/search/directives/search-result.html",scope:{result:"="},link:function(e,t){}}})}();
!function(){"use strict";angular.module("bottletrade.search").directive("searchView",["$state","$timeout","lodash","BeerManager","BreweryManager","SpiritManager","DistilleryManager","WineManager","WineryManager",function(e,n,r,t,i,a,s,c,u){return{replace:!0,templateUrl:"/bottletrade/search/directives/search-view.html",scope:{query:"="},link:function(e,o){var l=null,f="";e.results=[],e.loading=!1,e.performSearch=function(o){function y(r,t,i){l===g&&(i.$id=t,n(function(){var n={};n.type=r,n[r]=i,e.results.push(n)}))}function h(t,i,a){l===g&&n(function(){r.remove(e.results,function(e){return e.type==t&&e[t].$id==i})})}var g;o!==f&&(g=new Date,l=g,f=o,e.results.splice(0,e.results.length),t.searchByNameBegins(o,function(e,n){y("beer",e,n)},function(e,n){h("beer",e,n)}),i.searchByNameBegins(o,function(e,n){y("brewery",e,n)},function(e,n){h("brewery",e,n)}),a.searchByNameBegins(o,function(e,n){y("spirit",e,n)},function(e,n){h("spirit",e,n)}),s.searchByNameBegins(o,function(e,n){y("distillery",e,n)},function(e,n){h("distillery",e,n)}),c.searchByNameBegins(o,function(e,n){y("wine",e,n)},function(e,n){h("wine",e,n)}),u.searchByNameBegins(o,function(e,n){y("winery",e,n)},function(e,n){h("winery",e,n)}))},e.$watch("query",function(n,r){n?e.performSearch(n):(f="",l=new Date,e.results.splice(0,e.results.length))})}}}])}();
!function(){"use strict";angular.module("bottletrade.spirits").directive("addSpirit",["SpiritList",function(t){return{replace:!0,templateUrl:"/bottletrade/spirits/directives/add-spirit.html",scope:{created:"&"},link:function(i,e){i.spirit={name:""},i.save=function(){t.$add(i.spirit).then(function(t){i.created({spirit:t})})}}}}])}();
!function(){"use strict";angular.module("bottletrade.spirits").directive("spiritDisplay",function(){return{replace:!0,templateUrl:"/bottletrade/spirits/directives/spirit-display.html",scope:{spirit:"="},link:function(t,i){}}})}();
!function(){"use strict";angular.module("bottletrade.spirits").directive("spiritSummary",function(){return{replace:!0,templateUrl:"/bottletrade/spirits/directives/spirit-summary.html",scope:{spirit:"="},link:function(t,i){}}})}();
!function(){"use strict";angular.module("bottletrade.search").factory("SearchService",function(){function e(e){t.query=e}function r(){return t}var t={query:""};return{setQuery:e,getConfig:r}})}();
!function(){"use strict";angular.module("bottletrade.spirits").factory("Spirit",["$firebaseObject","firebaseRef","BTConstants",function(e,t,r){return function(n){var s=e.$extend({$save:function(){return this.search_name=this.name.toLowerCase(),e.prototype.$save.call(this)}});return new s(t(r.firebase.spirits,n))}}])}();
!function(){"use strict";angular.module("bottletrade.spirits").factory("SpiritList",["$firebaseArray","firebaseRef","BTConstants",function(e,t,r){var a=e.$extend({$add:function(t){return t.search_name=t.name.toLowerCase(),e.prototype.$add.call(this,t)}});return new a(t(r.firebase.spirits))}])}();
!function(){"use strict";angular.module("bottletrade.spirits").factory("SpiritManager",["firebaseRef","BTConstants",function(n,e){function t(n,e,t){return o(n,"","","","~",e,t)}function r(n,e,t){return o(n,"~","","~","",e,t)}function a(n,e,t){return o(n,"~","~","~","~",e,t)}function i(n,e,t){return o(n,"","","","",e,t)}function o(t,r,a,i,o,s,c){var u,f;u=t.toString().toLowerCase(),f=n(e.firebase.spirits).orderByChild("search_name").startAt(r+u+a).endAt(i+u+o),s&&f.on("child_added",function(n){s(n.key(),n.val())}),c&&f.on("child_removed",function(n){c(n.key(),n.val())})}return{searchByNameBegins:t,searchByNameEnds:r,searchByNameContains:a,searchByNameExact:i}}])}();
!function(){"use strict";angular.module("bottletrade.upload").directive("uploadData",["$q","$timeout","lodash","BreweryList","BeerList","BreweryManager","BeerManager","WineryList","WineList","WineryManager","WineManager","DistilleryList","SpiritList","DistilleryManager","SpiritManager",function(e,t,a,s,r,n,c,i,o,u,d,l,m,f,p){return{replace:!0,templateUrl:"/bottletrade/upload/directives/upload-data.html",scope:{fileData:"=",fileContents:"@",results:"="},link:function(y,g){function h(a){var s=e.defer();return t(function(){try{var e;if(a.addedCompany?a.correctCompany=w[a.company]:a.correctCompany||(a.correctCompany=E(a)),!a.addedBeverage||B(a)>0)s.resolve();else switch(y.fileContents){case"beers":e={name:a.beverage.toString(),brewery:a.correctCompany.$id},r.$add(e).then(function(e){a.correctBeverage=e,s.resolve()},function(){s.reject()});break;case"spirits":e={name:a.beverage.toString(),distillery:a.correctCompany.$id},m.$add(e).then(function(e){a.correctBeverage=e,s.resolve()},function(){s.reject()});break;case"wines":e={name:a.beverage.toString(),winery:a.correctCompany.$id},o.$add(e).then(function(e){a.correctBeverage=e,s.resolve()},function(){s.reject()})}}catch(t){s.reject()}}),s.promise}function v(e){if(e.matchedCompanies={},e.matchedBeverages={},e.status=C(e),e.company)switch(y.fileContents){case"beers":case"breweries":n.searchByNameExact(e.company,function(t,a){a.$id=t,e.matchedCompanies[t]=a,e.status=C(e)});break;case"wines":case"wineries":u.searchByNameExact(e.company,function(t,a){a.$id=t,e.matchedCompanies[t]=a,e.status=C(e)});break;case"spirits":case"distilleries":f.searchByNameExact(e.company,function(t,a){a.$id=t,e.matchedCompanies[t]=a,e.status=C(e)})}if(e.beverage)switch(y.fileContents){case"beers":c.searchByNameExact(e.beverage,function(t,a){a.$id=t,e.matchedBeverages[t]=a,e.status=C(e)});break;case"wines":d.searchByNameExact(e.beverage,function(t,a){a.$id=t,e.matchedBeverages[t]=a,e.status=C(e)});break;case"spirits":p.searchByNameExact(e.beverage,function(t,a){a.$id=t,e.matchedBeverages[t]=a,e.status=C(e)})}y.results.push(e)}function C(e){var t=!1,a=!1;if(!e.addedCompany&&0===b(e))return y.status.addCompany;if(!e.correctCompany&&b(e)>1)return y.status.selectCompany;if("beers"==y.fileContents||"wines"==y.fileContents||"spirits"==y.fileContents){if(!e.addedBeverage&&0===B(e))return y.status.addBeverage;if(!e.correctBeverage&&B(e)>1)return y.status.selectBeverage}if(t=1===b(e)||e.correctCompany||e.addedCompany,a=1===B(e)||e.correctBeverage||e.addedBeverage,"beers"==y.fileContents||"wines"==y.fileContents||"spirits"==y.fileContents){if(t&&a)return y.status.match}else if(t)return y.status.match;return y.status.error}function B(e){var t=e.matchedBeverages?Object.keys(e.matchedBeverages):null;return t?t.length:0}function b(e){var t=e.matchedCompanies?Object.keys(e.matchedCompanies):null;return t?t.length:0}function E(e){var t=Object.keys(e.matchedCompanies);return t.length>0?e.matchedCompanies[t[0]]:null}var w={},$={};switch(y.uploadComplete=!1,y.uploadInProgress=!1,y.status={addCompany:"",selectCompany:"",addBeverage:"",selectBeverage:"",match:"MATCH",error:"ERROR"},y.fileContents){case"beers":case"breweries":y.status.addCompany="ADD BREWERY",y.status.selectCompany="SELECT BREWERY",y.status.addBeverage="ADD BEER",y.status.selectBeverage="SELECT BEER";break;case"wines":case"wineries":y.status.addCompany="ADD WINERY",y.status.selectCompany="SELECT WINERY",y.status.addBeverage="ADD WINE",y.status.selectBeverage="SELECT WINE";break;case"spirits":case"distilleries":y.status.addCompany="ADD DISTILLERY",y.status.selectCompany="SELECT DISTILLERY",y.status.addBeverage="ADD SPIRIT",y.status.selectBeverage="SELECT SPIRIT"}y.fileData.forEach(function(e){v(e)}),y.save=function(){y.uploadReady()&&(y.uploadInProgress=!0,t(function(){var t=[];Object.keys(w).forEach(function(e){var a={name:e.toString(),description:$[e].description};switch(y.fileContents){case"beers":case"breweries":t.push(s.$add(a).then(function(t){a.$id=t.key(),w[e]=a}));break;case"wines":case"wineries":t.push(i.$add(a).then(function(t){a.$id=t.key(),w[e]=a}));break;case"spirits":case"distilleries":t.push(l.$add(a).then(function(t){a.$id=t.key(),w[e]=a}))}}),e.all(t).then(function(){var t=[];y.results.forEach(function(e){t.push(h(e))}),e.all(t).then(function(){y.uploadComplete=!0})["finally"](function(){y.uploadInProgress=!1})})["finally"](function(){y.uploadInProgress=!1})}))},y.selectCompany=function(e){switch(e.matchedBeverages={},e.status=C(e),y.fileContents){case"beers":c.searchByNameExactFromBrewery(e.beverage,e.correctCompany.$id,function(t,a){e.matchedBeverages[t]=a,e.status=C(e)});break;case"spirits":p.searchByNameExactFromBrewery(e.beverage,e.correctCompany.$id,function(t,a){e.matchedBeverages[t]=a,e.status=C(e)});break;case"wines":d.searchByNameExactFromBrewery(e.beverage,e.correctCompany.$id,function(t,a){e.matchedBeverages[t]=a,e.status=C(e)})}},y.addCompany=function(e){if(angular.isUndefined(w[e])){w[e]=null;var t=a.first(y.results,function(t){return t.company===e});if(angular.isUndefined(t))return;$[e]={description:t.description},y.results.forEach(function(t){t.status===y.status.addCompany&&t.company===e&&(t.addedCompany=!0,t.status=C(t))})}},y.selectBeverage=function(e,t){e.correctBeverage=t,e.status=C(e)},y.addBeverage=function(e){e.addedBeverage=!0,e.status=C(e)},y.uploadReady=function(){return!y.uploadComplete&&!y.uploadInProgress&&!a.find(y.results,function(e){return e.status!==y.status.match})}}}}])}();
!function(){"use strict";angular.module("bottletrade.common").factory("spreadsheetParser",["$q","$log",function(r,e){function n(r){var e=[];return c(r).forEach(function(r){e.push({company:r[u.brewery.name],description:r[u.brewery.description]})}),e}function i(r){var e=[];return c(r).forEach(function(r){e.push({company:r[u.beer.brewery],beverage:r[u.beer.name]})}),e}function t(r){var e=[];return c(r).forEach(function(r){e.push({company:r[u.winery.name],description:r[u.winery.description]})}),e}function a(r){var e=[];return c(r).forEach(function(r){e.push({company:r[u.wine.winery],beverage:r[u.wine.name]})}),e}function o(r){var e=[];return c(r).forEach(function(r){e.push({company:r[u.distillery.name],description:r[u.distillery.description]})}),e}function s(r){var e=[];return c(r).forEach(function(r){e.push({company:r[u.spirit.distillery],beverage:r[u.spirit.name]})}),e}function c(r,e){e=e||function(r,e,n){return n};for(var n,i,t,a=r.split(""),o=0,s=a.length,c=[];o<s;){for(c.push(t=[]);o<s&&"\r"!==a[o]&&"\n"!==a[o];){if(n=i=o,'"'===a[o]){for(n=i=++o;o<s;){if('"'===a[o]){if('"'!==a[o+1])break;a[++o]=""}i=++o}for('"'===a[o]&&++o;o<s&&"\r"!==a[o]&&"\n"!==a[o]&&","!==a[o];)++o}else for(;o<s&&"\r"!==a[o]&&"\n"!==a[o]&&","!==a[o];)i=++o;i=e(c.length-1,t.length,a.slice(n,i).join("")),t.push(isNaN(i)?i:+i),","===a[o]&&++o}"\r"===a[o]&&++o,"\n"===a[o]&&++o}return c}var u={brewery:{name:0,description:1},beer:{brewery:0,name:1},winery:{name:0,description:1},wine:{winery:0,name:1},distillery:{name:0,description:1},spirit:{distillery:0,name:1}};return{parseBreweryCsv:n,parseBeerCsv:i,parseWineryCsv:t,parseWineCsv:a,parseDistilleryCsv:o,parseSpiritCsv:s}}])}();
!function(){"use strict";angular.module("bottletrade.wineries").directive("addWinery",["WineryList",function(e){return{replace:!0,templateUrl:"/bottletrade/wineries/directives/add-winery.html",scope:{created:"&"},link:function(n,t){n.winery={name:""},n.save=function(){e.$add(n.winery).then(function(e){n.created({winery:e})})}}}}])}();
!function(){"use strict";angular.module("bottletrade.wineries").directive("wineryDisplay",function(){return{replace:!0,templateUrl:"/bottletrade/wineries/directives/winery-display.html",scope:{winery:"="},link:function(e,i){}}})}();
!function(){"use strict";angular.module("bottletrade.wineries").directive("winerySummary",function(){return{replace:!0,templateUrl:"/bottletrade/wineries/directives/winery-summary.html",scope:{winery:"="},link:function(e,r){}}})}();
!function(){"use strict";angular.module("bottletrade.wineries").factory("Winery",["$firebaseObject","firebaseRef","BTConstants",function(e,t,n){return function(r){var a=e.$extend({$save:function(){return this.search_name=this.name.toLowerCase(),e.prototype.$save.call(this)}});return new a(t(n.firebase.wineries,r))}}])}();
!function(){"use strict";angular.module("bottletrade.wineries").factory("WineryList",["$firebaseArray","firebaseRef","BTConstants",function(e,r,t){var n=e.$extend({$add:function(r){return r.search_name=r.name.toLowerCase(),e.prototype.$add.call(this,r)}});return new n(r(t.firebase.wineries))}])}();
!function(){"use strict";angular.module("bottletrade.wineries").factory("WineryManager",["firebaseRef","BTConstants",function(e,n){function r(e,n,r){return o(e,"","","","~",n,r)}function t(e,n,r){return o(e,"~","","~","",n,r)}function a(e,n,r){return o(e,"~","~","~","~",n,r)}function i(e,n,r){return o(e,"","","","",n,r)}function o(r,t,a,i,o,c,s){var u,f;u=r.toString().toLowerCase(),f=e(n.firebase.wineries).orderByChild("search_name").startAt(t+u+a).endAt(i+u+o),c&&f.on("child_added",function(e){c(e.key(),e.val())}),s&&f.on("child_removed",function(e){s(e.key(),e.val())})}return{searchByNameBegins:r,searchByNameEnds:t,searchByNameContains:a,searchByNameExact:i}}])}();
!function(){"use strict";angular.module("bottletrade").directive("addWine",["WineList",function(e){return{replace:!0,templateUrl:"/bottletrade/wines/directives/add-wine.html",scope:{created:"&"},link:function(t,n){t.wine={name:""},t.save=function(){e.$add(t.wine).then(function(e){t.created({wine:e})})}}}}])}();
!function(){"use strict";angular.module("bottletrade.wines").directive("wineDisplay",function(){return{replace:!0,templateUrl:"/bottletrade/wines/directives/wine-display.html",scope:{wine:"="},link:function(e,t){}}})}();
!function(){"use strict";angular.module("bottletrade.wines").directive("wineSummary",function(){return{replace:!0,templateUrl:"/bottletrade/wines/directives/wine-summary.html",scope:{wine:"="},link:function(e,t){}}})}();
!function(){"use strict";angular.module("bottletrade.wines").factory("Wine",["$firebaseObject","firebaseRef","BTConstants",function(e,t,n){return function(r){var a=e.$extend({$save:function(){return this.search_name=this.name.toLowerCase(),e.prototype.$save.call(this)}});return new a(t(n.firebase.wines,r))}}])}();
!function(){"use strict";angular.module("bottletrade.wines").factory("WineList",["$firebaseArray","firebaseRef","BTConstants",function(e,t,n){var a=e.$extend({$add:function(t){return t.search_name=t.name.toLowerCase(),e.prototype.$add.call(this,t)}});return new a(t(n.firebase.wines))}])}();
!function(){"use strict";angular.module("bottletrade.wines").factory("WineManager",["firebaseRef","BTConstants",function(n,e){function t(n,e,t){return o(n,"","","","~",e,t)}function r(n,e,t){return o(n,"~","","~","",e,t)}function a(n,e,t){return o(n,"~","~","~","~",e,t)}function i(n,e,t){return o(n,"","","","",e,t)}function o(t,r,a,i,o,c,s){var u,f;u=t.toString().toLowerCase(),f=n(e.firebase.wines).orderByChild("search_name").startAt(r+u+a).endAt(i+u+o),c&&f.on("child_added",function(n){c(n.key(),n.val())}),s&&f.on("child_removed",function(n){s(n.key(),n.val())})}return{searchByNameBegins:t,searchByNameEnds:r,searchByNameContains:a,searchByNameExact:i}}])}();
!function(){"use strict";angular.module("application",["ui.router","ngAnimate","ngResource","ngLodash","bottletrade.firebase","base","base.dynamicRouting","base.dynamicRouting.animations","bottletrade","ngSVGAttributes"]),angular.module("application").config(["$urlRouterProvider","$locationProvider","$stateProvider",function(e,t,a){e.otherwise("/"),t.html5Mode({enabled:!1,requireBase:!1}),t.hashPrefix("!"),a.state("app",{controller:"IndexCtrl",templateUrl:"templates/app.html",authRequired:!1,"abstract":!0,resolve:{user:["Auth","$rootScope",function(e,t){var a=e.$waitForAuth();return a.then(function(e){t.user=e}),a}]}})}]),angular.module("application").run(["$rootScope","$state","Auth","SearchService",function(e,t,a,o){FastClick.attach(document.body),e.$on("$stateChangeError",function(e,a,o,n,r,u){"AUTH_REQUIRED"===u&&t.go("app.home")}),e.$on("$stateChangeSuccess",function(e,t,a,n,r){"app.search"!==t&&o.setQuery("")}),a.$onAuth(function(a){e.user=a,a||t.go("app.home")})}])}();
!function(){"use strict";angular.module("application").controller("IndexCtrl",["$scope","$state","$timeout","Auth","FoundationApi","SearchService","user",function(e,n,o,u,t,c,i){e.auth=u,e.searchConfig=c.getConfig(),e.$watch("searchConfig.query",function(e){n.includes("app.search")?n.go("app.search",{query:e},{notify:!1}):e&&n.go("app.search",{query:e})}),e.closeMenu=function(){o(function(){t.publish("menu","close")})},e.toggleMenu=function(){o(function(){t.publish("menu","toggle")})}}])}();
!function(){"use strict";angular.module("application").controller("AccountCtrl",["$scope","$state","Auth","firebaseRef","user",function(e,o,t,i,a){e.providers=[{id:"twitter",name:"Twitter"},{id:"facebook",name:"Facebook"},{id:"google",name:"Google"},{id:"email",name:"BottleTrade"}],e.email="",e.password="",e.selectProvider=function(a){e.provider=a,"BottleTrade"!=a.name&&i().authWithOAuthPopup(a.id,function(e,i){e?console.log("Login Failed!",e):(console.log("Authenticated successfully with payload:",i),t.$waitForAuth().then(function(e){o.go("app.profile")}))})},e.createUser=function(){e.message=null,e.error=null,t.$createUser({email:e.email,password:e.password}).then(function(o){e.message="User created with uid: "+o.uid})["catch"](function(o){e.error=o})}}])}();
!function(){"use strict";angular.module("application").controller("BeersCtrl",["$scope","$state","$stateParams","$timeout","Beer","BeerList","BeerManager","FoundationApi",function(e,t,o,a,n,i,c,r){if(o.id&&"new"!==o.id?e.beer=new n(o.id):(e.beers=i,"new"===o.id&&(e.action="new")),o.action)switch(o.action){case"cellar":e.action="cellar";break;case"edit":e.action="edit"}e.created=function(o){var n=e.beers.$getRecord(o.key());t.go("app.beers",{id:o.key()}),a(function(){r.publish("app-notifications",{title:"Beer Added!",content:n.name+" has been added to the BottleTrade network",color:"success",autoclose:"5000"})})},e.updated=function(o){var n=e.beer;t.go("app.beers",{id:o.key()}),a(function(){r.publish("app-notifications",{title:"Beer Updated!",content:n.name+" has been updated in the BottleTrade network",color:"success",autoclose:"5000"})})},e.addedToCellar=function(o){o.once("value",function(o){var n=e.beer;t.go("app.cellar",{},{reload:!0}),a(function(){r.publish("app-notifications",{title:"Bottle Added!",content:n.name+" has been added to your cellar",color:"success",autoclose:"5000"})})})}}])}();
!function(){"use strict";angular.module("application").controller("BottlesCtrl",["$scope","$state","$stateParams","$rootScope","$timeout","FoundationApi","Bottle","BottleList","BottleManager",function(t,o,e,i,a,n,l,c,s){if(e.id?t.bottle=new l(e.id):t.bottles=new c,t.bottleMgr=s,e.action)switch(e.action){case"edit":t.action="edit"}t.updated=function(t){o.go("app.bottles",{id:t.key()})}}])}();
!function(){"use strict";angular.module("application").controller("BreweriesCtrl",["$scope","$state","$stateParams","$timeout","FoundationApi","Brewery","BreweryList",function(e,t,r,o,i,n,a){r.id?e.brewery=new n(r.id):e.breweries=a,e.created=function(r){var n=e.breweries.$getRecord(r.key());t.go("app.breweries",{id:r.key()}),o(function(){i.publish("app-notifications",{title:"Brewery Added!",content:n.name+" has been added to the BottleTrade network",color:"success",autoclose:"5000"})})},e.updated=function(r){var n=e.brewery;t.go("app.breweries",{id:r.key()}),o(function(){i.publish("app-notifications",{title:"Brewery Updated!",content:n.name+" has been updated in the BottleTrade network",color:"success",autoclose:"5000"})})}}])}();
!function(){"use strict";angular.module("application").controller("CellarCtrl",["$scope","user","BottleList","BottleManager",function(t,e,l,o){t.bottles=new l,t.bottleMgr=o}])}();
!function(){"use strict";angular.module("application").controller("DistilleriesCtrl",["$scope","$state","$stateParams","Distillery","DistilleryList",function(i,t,e,l,s){e.id?i.distillery=new l(e.id):i.distilleries=s,i.created=function(i){t.go("app.distilleries",{id:i.key()})}}])}();
!function(){"use strict";angular.module("application").controller("HomeCtrl",["$scope","Auth","firebaseRef","user",function(e,o,t,i){e.user=i,e.providers=[{id:"twitter",name:"Twitter"},{id:"facebook",name:"Facebook"},{id:"google",name:"Google"},{id:"email",name:"BottleTrade"}]}])}();
!function(){"use strict";angular.module("application").controller("ProfileCtrl",["$scope","user","BottleList","BottleManager",function(t,e,o,l){t.bottles=new o,t.bottleMgr=l}])}();
!function(){"use strict";angular.module("application").controller("SearchCtrl",["$scope","$stateParams","SearchService",function(e,r,t){r.query&&t.setQuery(r.query),e.searchConfig=t.getConfig()}])}();
!function(){"use strict";angular.module("application").controller("SpiritsCtrl",["$scope","$state","$stateParams","Spirit","SpiritList",function(i,t,r,s,p){r.id?i.spirit=new s(r.id):i.spirits=p,i.created=function(i){t.go("app.spirits",{id:i.key()})}}])}();
!function(){"use strict";angular.module("application").controller("UploadCtrl",["$scope","$timeout","$state","$stateParams","fileReader","spreadsheetParser","BeerList","BeerManager","BreweryList","BreweryManager","WineList","WineManager","WineryList","WineryManager","SpiritList","SpiritManager","DistilleryList","DistilleryManager",function(e,s,i,t,l,n,a,r,f,u,c,p,o,d,v,W,h,m){e.parsedResults=[],e.fileResults=[],e.fileContents="",e.fileData="",e.file=null,e.$watch("fileContents",function(e){e&&i.go(".",{type:e},{notify:!1})}),e.clickFileInput=function(){s(function(){document.getElementById("spreadsheetFileUpload").click()})},e.upload=function(){l.readAsText(e.file,e).then(function(s){switch(e.fileResults.splice(0,e.fileResults.length),e.parsedResults.splice(0,e.parsedResults.length),e.fileContents){case"beers":e.file.name.endsWith(".csv")?e.fileResults=n.parseBeerCsv(s):e.file.name.endsWith(".tsv")&&(e.fileResults=n.parseBeerTsv(s));break;case"breweries":e.file.name.endsWith(".csv")?e.fileResults=n.parseBreweryCsv(s):e.file.name.endsWith(".tsv")&&(e.fileResults=n.parseBreweryTsv(s));break;case"wines":e.file.name.endsWith(".csv")?e.fileResults=n.parseWineCsv(s):e.file.name.endsWith(".tsv")&&(e.fileResults=n.parseWineTsv(s));break;case"wineries":e.file.name.endsWith(".csv")?e.fileResults=n.parseWineryCsv(s):e.file.name.endsWith(".tsv")&&(e.fileResults=n.parseWineryTsv(s));break;case"spirits":e.file.name.endsWith(".csv")?e.fileResults=n.parseWineCsv(s):e.file.name.endsWith(".tsv")&&(e.fileResults=n.parseWineTsv(s));break;case"distilleries":e.file.name.endsWith(".csv")?e.fileResults=n.parseDistilleryCsv(s):e.file.name.endsWith(".tsv")&&(e.fileResults=n.parseDistilleryTsv(s))}})},s(function(){t.type&&(e.fileContents=t.type)})}]),angular.module("application").directive("ngFileSelect",["$timeout",function(e){return{link:function(s,i,t){i.bind("change",function(i){e(function(){s.file=(i.srcElement||i.target).files[0],s.upload()})})}}}])}();
!function(){"use strict";angular.module("application").controller("WineriesCtrl",["$scope","$state","$stateParams","Winery","WineryList",function(e,i,n,t,r){n.id?e.winery=new t(n.id):e.wineries=r,e.created=function(e){i.go("app.wineries",{id:e.key()})}}])}();
!function(){"use strict";angular.module("application").controller("WinesCtrl",["$scope","$state","$stateParams","Wine","WineList",function(e,i,n,t,a){n.id?e.wine=new t(n.id):e.wines=a,e.created=function(e){i.go("app.wines",{id:e.key()})}}])}();